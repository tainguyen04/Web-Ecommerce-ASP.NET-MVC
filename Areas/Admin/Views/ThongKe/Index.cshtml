@{
    ViewData["Title"] = "Thống kê doanh thu";
}

<h2 class="mb-4">Thống kê doanh thu theo khoảng thời gian</h2>

<!-- FORM CHỌN KHOẢNG NGÀY -->
<form method="post" class="row g-3 mb-4">
    <div class="col-md-3">
        <label class="form-label">Từ ngày</label>
        <input type="date" name="tuNgay" class="form-control" required value="@ViewBag.TuNgay" />
    </div>
    <div class="col-md-3">
        <label class="form-label">Đến ngày</label>
        <input type="date" name="denNgay" class="form-control" required value="@ViewBag.DenNgay" />
    </div>
    <div class="col-md-3 align-self-end">
        <button type="submit" class="btn btn-primary w-100">
            <i class="fas fa-search"></i> Thống kê
        </button>
    </div>
</form>

<!-- HIỂN THỊ LỖI NẾU CÓ -->
@if (ViewBag.Error != null)
{
    <div class="alert alert-danger">@ViewBag.Error</div>
}

<!-- HIỂN THỊ KẾT QUẢ -->
@if (ViewBag.DoanhThu != null)
{
    <div class="alert alert-success">
        <h4 class="mb-0">
            Doanh thu từ <strong>@ViewBag.TuNgay</strong> đến <strong>@ViewBag.DenNgay</strong>:
            <span class="text-danger">@String.Format("{0:N0}", ViewBag.DoanhThu) VNĐ</span>
        </h4>
    </div>

    <h4 class="mt-4">Danh sách hóa đơn</h4>
    <table class="table table-bordered table-hover">
        <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>Ngày bán</th>
                <th>Tổng tiền</th>
                <th>Khách hàng</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in ViewBag.DanhSach)
            {
                <tr>
                    <td>@item.Id</td>
                    <td>@item.NgayBan.ToString("dd/MM/yyyy")</td>
                    <td>@String.Format("{0:N0}", item.TongTien) VNĐ</td>
                    <td>@(item.KhachHang != null ? item.KhachHang.TenKhachHang : "Khách vãng lai")</td>
                </tr>
            }
        </tbody>
    </table>
}
